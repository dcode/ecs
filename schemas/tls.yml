---
- name: tls
  title: TLS
  group: 2
  short: Fields describing a TLS connection.
  description: >
    Fields related to TLS activity.
  type: group
  fields:

    - name: version.protocol
      level: extended
      type: keyword
      description: Normalized protocol name parsed from original string (e.g. ssl, tls).

    - name: version.number
      level: extended
      type: keyword
      description: Numeric part of the version parsed from the original string (e.g. 1.2, 3).

    - name: cipher
      type: keyword
      level: extended
      description: String indicating the cipher used during the current connection.

    - name: curve
      type: keyword
      level: extended
      description: String indicating the curve used for the given cipher, when applicable.

    - name: resumed
      type: boolean
      level: extended
      description: Boolean flag indicating if this TLS connection was resumed from an existing TLS negotiation.

    - name: next_protocol
      type: keyword
      level: extended
      description: String indicating the protocol being tunneled (e.g. http/1.1, spdy/3, imap, webrtc)

    - name: client.ja3
      type: keyword
      level: extended
      description: A hash that identifies clients based on how they perform an SSL/TLS handshake.

    - name: client.server_name
      type: keyword
      level: extended
      description: >
        Also called an SNI, this tells the server which hostname to which the client is attempting to connect.

    - name: client.supported_ciphers
      type: keyword
      level: extended
      description: List of ciphers offered by the client during the client hello.

    - name: client.subject
      type: keyword
      level: extended
      description: Subject of the x.509 certificate presented by the client.

    - name: client.issuer
      type: keyword
      level: extended
      description: Subject of the issuer of the x.509 certificate presented by the client.

    - name: client.not_before
      type: date
      level: extended
      description: Timestamp indicating when client certificate is first considered valid.

    - name: client.not_after
      type: date
      level: extended
      description: Timestamp indicating when client certificate is no longer considered valid.

    - name: client.certificate_chain
      type: keyword
      level: extended
      description: List of PEM-encoded certificates that make up the certificate chain offered by the client.

    - name: client.certificate
      type: keyword
      level: extended
      description: PEM-encoded stand-alone certificate offered by the client.

    - name: client.hash.md5
      type: keyword
      level: extended
      description: >
        Certificate fingerprint using the MD5 digest of DER-encoded version of certificate offered by the client.
        For consistency with other hash values, this value should be formatted as an uppercase hash
        (e.g. `0F76C7F2C55BFD7D8E8B8F4BFBF0C9EC`).

    - name: client.hash.sha1
      type: keyword
      level: extended
      description: >
        Certificate fingerprint using the SHA1 digest of DER-encoded version of certificate offered by the client.
        For consistency with other hash values, this value should be formatted as an uppercase hash
        (e.g. `9E393D93138888D288266C2D915214D1D1CCEB2A`).

    - name: client.hash.sha256
      type: keyword
      level: extended
      description: >
        Certificate fingerprint using the SHA256 digest of DER-encoded version of certificate offered by the client.
        For consistency with other hash values, this value should be formatted as an uppercase hash
        (e.g. `0687F666A054EF17A08E2F2162EAB4CBC0D265E1D7875BE74BF3C712CA92DAF0`).

    - name: server.ja3s
      type: keyword
      level: extended
      description: A hash that identifies servers based on how they perform an SSL/TLS handshake.

    - name: server.supported_ciphers
      type: keyword
      level: extended
      description: List of ciphers offered by the server during the server hello.

    - name: server.subject
      type: keyword
      level: extended
      description: Subject of the x.509 certificate presented by the server.

    - name: server.issuer
      type: keyword
      level: extended
      description: Subject of the issuer of the x.509 certificate presented by the server.

    - name: server.not_before
      type: date
      level: extended
      description: Timestamp indicating when server certificate is first considered valid.

    - name: server.not_after
      type: date
      level: extended
      description: Timestamp indicating when server certificate is no longer considered valid.

    - name: server.certificate_chain
      type: keyword
      level: extended
      description: List of PEM-encoded certificates that make up the certificate chain offered by the server.

    - name: server.certificate
      type: keyword
      level: extended
      description: PEM-encoded stand-alone certificate offered by the server.

    - name: server.hash.md5
      type: keyword
      level: extended
      description: >
        Certificate fingerprint using the MD5 digest of DER-encoded version of certificate offered by the server.
        For consistency with other hash values, this value should be formatted as an uppercase hash
        (e.g. `0F76C7F2C55BFD7D8E8B8F4BFBF0C9EC`).

    - name: server.hash.sha1
      type: keyword
      level: extended
      description: >
        Certificate fingerprint using the SHA1 digest of DER-encoded version of certificate offered by the server.
        For consistency with other hash values, this value should be formatted as an uppercase hash
        (e.g. `9E393D93138888D288266C2D915214D1D1CCEB2A`).

    - name: server.hash.sha256
      type: keyword
      level: extended
      description: >
        Certificate fingerprint using the SHA256 digest of DER-encoded version of certificate offered by the server.
        For consistency with other hash values, this value should be formatted as an uppercase hash
        (e.g. `0687F666A054EF17A08E2F2162EAB4CBC0D265E1D7875BE74BF3C712CA92DAF0`).

